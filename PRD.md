# 房屋貸款計算機 - 產品需求文檔 (PRD)

## 1. 產品概述

### 1.1 產品名稱
房屋貸款計算機 (Mortgage Calculator)

### 1.2 產品定位
提供台灣房屋貸款試算的純前端網頁應用程式，支援新青安等政府優惠貸款方案，幫助使用者快速了解每月還款金額及利息分配。

### 1.3 目標用戶
- 首購族
- 換屋族
- 房地產投資者
- 金融從業人員

## 2. 功能需求

### 2.1 核心功能

#### 2.1.1 貸款金額輸入
- **輸入模式切換**
  - 模式一：輸入房屋總價 + 貸款成數
  - 模式二：直接輸入貸款金額
- **自動轉換計算**
  - 輸入房屋總價時，自動計算貸款金額
  - 輸入貸款金額時，可反推房屋總價（需輸入貸款成數）

#### 2.1.2 還款試算
- **每月還款明細**
  - 顯示每月應繳總額
  - 區分本金與利息
  - 顯示累計已繳本金/利息
- **還款方式**
  - 本息平均攤還
  - 本金平均攤還（選配功能）
- **即時計算**
  - 所有欄位變更時自動重新計算
  - 無需按下送出按鈕

#### 2.1.3 多段式利率支援
- **新青安貸款**
  - 第1-2年：1.775%
  - 第3年起：2.075%
  - 最高貸款額度：1000萬
  - 貸款年限：最長40年
- **一般房貸利率**
  - 支援固定利率
  - 支援浮動利率（基準利率 + 加碼）
- **自訂利率段數**
  - 可新增多個利率期間
  - 每段可設定起迄期間與利率

### 2.2 輔助功能

#### 2.2.1 防呆機制
- **輸入驗證**
  - 數值範圍檢查（如：貸款成數 0-100%）
  - 格式驗證（禁止非數字輸入）
  - 邏輯檢查（如：貸款金額不可超過房屋總價）
- **錯誤提示**
  - 即時顯示錯誤訊息
  - 標記錯誤欄位
  - 提供修正建議

#### 2.2.2 政策說明
- **新青安專區**
  - 申請資格說明
  - 優惠內容比較
  - 注意事項提醒
- **相關政策連結**
  - 財政部公告
  - 各銀行方案比較
  - 常見問題FAQ

#### 2.2.3 試算結果輸出
- **視覺化圖表**
  - 本金/利息比例圓餅圖
  - 還款進度條形圖
  - 利率變化趨勢圖
- **資料匯出**
  - 匯出為 PDF 報表
  - 匯出為 Excel 試算表
  - 分享連結功能

## 3. 技術規格

### 3.1 前端技術架構
- **框架**: React 18 (穩定版)
- **語言**: TypeScript 5.x
- **狀態管理**: React Context API 或 Zustand
- **樣式方案**: TailwindCSS 或 CSS Modules
- **打包工具**: Vite

### 3.2 程式架構
```
src/
├── components/          # UI 元件
│   ├── Calculator/     # 計算機主元件
│   ├── InputFields/    # 輸入欄位元件
│   ├── Results/        # 結果顯示元件
│   └── Charts/         # 圖表元件
├── hooks/              # 自訂 Hooks
├── utils/              # 工具函數
│   ├── calculations/   # 貸款計算邏輯
│   └── validations/    # 輸入驗證
├── types/              # TypeScript 型別定義
└── constants/          # 常數定義（利率、政策等）
```

### 3.3 核心計算邏輯

#### 本息平均攤還公式
```typescript
// 每月應付本息金額
monthlyPayment = principal * (rate * (1 + rate)^n) / ((1 + rate)^n - 1)

// 其中：
// principal = 貸款本金
// rate = 月利率（年利率/12）
// n = 總期數（貸款年限*12）
```

## 4. 使用者介面設計

### 4.1 版面配置
- **單頁式設計 (One Page)**
  - 上方：輸入區塊
  - 中間：即時計算結果
  - 下方：詳細還款明細表

### 4.2 響應式設計
- **桌面版**: 雙欄式布局
- **平板版**: 單欄加摺疊選單
- **手機版**: 垂直堆疊，步驟式導引

### 4.3 互動設計
- **即時回饋**
  - 輸入時立即顯示計算結果
  - 載入狀態提示
  - 平滑的數字變化動畫
- **使用者引導**
  - 首次使用教學
  - 工具提示（Tooltip）
  - 情境式說明

## 5. 非功能性需求

### 5.1 效能需求
- 頁面載入時間 < 2秒
- 計算回應時間 < 100ms
- 支援離線使用（PWA）

### 5.2 相容性需求
- 瀏覽器支援：Chrome、Firefox、Safari、Edge（最新兩個版本）
- 裝置支援：桌機、平板、手機
- 最小螢幕寬度：320px

### 5.3 可及性需求
- 符合 WCAG 2.1 AA 標準
- 鍵盤導航支援
- 螢幕閱讀器相容

## 6. 開發階段規劃

### Phase 1: 基礎功能 (MVP)
- 基本貸款計算
- 單一利率支援
- 簡單結果顯示

### Phase 2: 進階功能
- 多段式利率
- 新青安方案
- 圖表視覺化

### Phase 3: 優化與擴充
- 匯出功能
- 進階防呆機制
- 效能優化

## 7. 成功指標

### 7.1 使用者體驗指標
- 計算準確度：100%
- 介面操作滿意度：> 4.5/5
- 平均使用時間：< 3分鐘完成試算

### 7.2 技術指標
- Lighthouse 分數：> 90
- 無障礙測試通過率：100%
- 單元測試覆蓋率：> 80%

## 8. 風險評估與對策

### 8.1 技術風險
- **風險**：瀏覽器相容性問題
- **對策**：使用 Polyfill、Progressive Enhancement

### 8.2 使用者風險
- **風險**：計算邏輯理解困難
- **對策**：提供詳細說明、範例試算

### 8.3 政策風險
- **風險**：貸款政策變更
- **對策**：模組化設計，便於快速更新

## 9. 未來擴充規劃

- 整合銀行 API 取得即時利率
- 加入房價趨勢分析
- 提供個人化貸款建議
- 多語言支援（簡體中文、英文）
- 行動應用程式版本

## 10. 參考資源

- [財政部新青安優惠房貸](https://www.mof.gov.tw/)
- [中央銀行利率政策](https://www.cbc.gov.tw/)
- [各大銀行房貸方案比較](https://www.banking.gov.tw/)